library(ISLR)
library(caret)
library(arm)
library(Ecdat)
library(gridExtra)
install.packages('arm')
install.packages('Ecdat')
library(ISLR)
library(caret)
library(arm)
library(Ecdat)
library(gridExtra)
data('Hedonic')
str(hedono)
str(Hedonic)
?Hedonic
inTrain <- createDataPartition(y = Hedonic$tax, p = 0.7, list = FALSE)
trainingset <- Hedonic[inTrain,]
testingset <- Hedonic[-inTrain,]
inTrain
trainingset
testingset
dim(trainingset)
dim(testingset)
ols.reg <- lm(tax~. , trainingset)
summary(ols.reg)
# predict
ols.regTest <- predict.lm(ols.reg, testingset, interval = 'prediction', se.fit = T)
ols.regTest
head(testingset)
head(testingset$tax)
head(ols.regTest)
head(ols.regTest$fit)
head(testingset$tax)
cor(testingset$tax, ols.regTest$fit[,1])
testingset$tax
ols.regTest$fit[,1]
ols.regTest$fit
summary(ols.regTest$fit[,1])
summary(trainingset$tax)
mean(abs(actual - predicted))
MAE(ols.regTest$fit[,1], testingset$tax)
mean(abs( real - predicted))
mean(abs({real-predicted}))
mean(abs(real-predicted))
MAE <- function(real, predicted){
mean(abs(real-predicted))
}
MAE(ols.regTest$fit[,1], testingset$tax)
MAE <- function(actuals, predicted){
mean(abs(actuals-predicted))
}
MAE(ols.regTest$fit[,1], testingset$tax)
yout.ols <- as.data.frame(cbind(testingset$tax, ols.regTest$fit))
yout.ols
ols.upr <- yout.ols$upr
ols.lwr <- yout.ols$lwr
ols.lwr
testingset$tax
p.ols <- ggolot(data = yout.ols, aes(x = testingset$tax, y = ols.regTest$fit[,1]))+
geom_point()+
ggtitle('ordianry regression')+
labs(x = 'actual', y ='predicted')
p.ols <- ggplot(data = yout.ols, aes(x = testingset$tax, y = ols.regTest$fit[,1]))+
geom_point()+
ggtitle('ordianry regression')+
labs(x = 'actual', y ='predicted')
p.ols+geom_errorbar(ymin = ols.lwr, ymax= ols.upr)
bayes.reg<-bayesglm(tax~.,family=gaussian(link=identity),trainingset,prior.df = Inf)
cor(testingset$tax,bayes.regTest$fit)
bayes.regTest<-predict.glm(bayes.reg,newdata = testingset,se.fit = T)
cor(testingset$tax,bayes.regTest$fit)
summary(bayes.regTest$fit)
bayes.reg<-bayesglm(tax~.,family=gaussian(link=identity),trainingset,prior.df = Inf)
bayes.regTest<-predict.glm(bayes.reg,newdata = testingset,se.fit = T)
cor(testingset$tax,bayes.regTest$fit)
summary(bayes.regTest$fit)
summary(trainingset$tax)
MAE(bayes.regTest$fit, testingset$tax)
yout.bayes <- as.data.frame(cbind(testingset$tax,bayes.regTest$fit))
names(yout.bayes) <- c("tax", "fit")
critval <- 1.96 #approx for 95% CI
bayes.upr <- bayes.regTest$fit + critval * bayes.regTest$se.fit
bayes.lwr <- bayes.regTest$fit - critval * bayes.regTest$se.fit
# plot
p.bayes <- ggplot(data = yout.bayes, aes(x = yout.bayes$tax,
y = yout.bayes$fit)) +
geom_point() +
ggtitle("Bayesian Regression Prediction") +
labs(x = "Actual", y = "Predicted")
ols.plot <-  p.ols + geom_errorbar(ymin = ols.lwr, ymax = ols.upr)
bayes.plot <-  p.bayes + geom_errorbar(ymin = bayes.lwr, ymax = bayes.upr)
grid.arrange(ols.plot,bayes.plot,ncol=2)
# (https://educationalresearchtechniques.com/2017/10/18/linear-regression-vs-bayesian-regression/)
bayes.regTest
head(bayes.regTest$fit)
head(ols.regTest$fit)
head(bayes.regTest)
head(bayes.regTest$fit)
head(bayes.regTest$fit)
head(trainingset$tax)
head(testingset$tax)
bayes_con <- as.data.frame(cbind(bayes.upr, bayes.lwr))
head(ols.regTest$fit)
head(bayes_con)
bayes_con <- as.data.frame(cbind(bayes.regTest,bayes.upr, bayes.lwr))
head(bayes_con)
bayes_con <- as.data.frame(cbind(bayes.regTest$fit,bayes.upr, bayes.lwr))
bayes_con <- as.data.frame(cbind(bayes.regTest$fit,bayes.upr, bayes.lwr))
head(bayes_con)
head(ols.regTest$fit)
bayes_con <- as.data.frame(cbind(bayes.regTest$fit, bayes.lwr,bayes.upr))
head(ols.regTest$fit)
head(ols.regTest$fit)
head(bayes_con)
# comparison
head(ols.regTest$fit)
head(bayes_con)
head(testingset$tax)
head(testingset$tax)
source('~/Documents/1. Online courses/3. Coursera/0.  Statistics with R-duke university/4. Bayesian Statistics/5. week 05/bayes_example.R')
install.packages('ISLR')
source('~/Documents/1. Online courses/3. Coursera/0.  Statistics with R-duke university/4. Bayesian Statistics/5. week 05/bayes_example.R')
